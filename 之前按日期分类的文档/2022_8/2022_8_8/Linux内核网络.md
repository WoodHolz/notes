# `Linux`内核网络

## 重要数据结构

* `Socket Buffer`数据结构`sk_buff`

* 网络设备数据结构`net_device`

> 程序的运行就是：读取数据结构的相关数据域，获取实体的属性，根据它们的当前值来分析数据包/网络设备的状态；修改数据结构的数据域或更新某些数据域的值来对数据包/网络设备作处理。数据结构设计得是否合理在很大程度上决定了：程序体系结构是否清晰；操作是否灵活；是否具备可扩展性。所以要理解 Linux 内核网络体系结构的设计思想和实现原理，首先应掌握代表网络子系统中各个实体的重要数据结构。

为什么`sk_buff`很重要？

> 因为其与TCP/IP协议栈关系密切，TCP/IP的各层中对`sk_buff`均有操作，不恰当地讲，整个过程像是发电报，数据包起初是要发送的话语，`sk_buff`就像写有这些话的草稿，TCP/IP在草稿上对话语进行简化，最后转发为统一的电码，满足发送条件



---



因为`sk_buff`是在原始数据从用户态进程进入内核时开始，有贯穿整个TCP/IP协议栈，可以代表数据包在内核中被处理的整个过程的特点；在未来学习中对其进行追踪可以帮助了解Linux内核网络的运行过程。



---



Linux 内核网络子系统的设计目标是使网络子系统的实现独立于特定的网络协议，让其他的网络协议能方便的加入。（接口实现？？？）

`sk_buff`的定义地址：`include/linux/skbuff.h`



![skbuff.h](.\skbuff.h.png)





## 完整Socket Buffer的组成

* `struct sk_buff`(管理数据结构)
* 数据包

其中`sk_buff`存放了数据包数据状态、接收/发送时间等**不需要发送**的信息

注：如果讨论的是数据包和管理数据结构的整体，会用 `Socket Buffer` 来描述；如果只是管理数据结构，会以 `sk_buff` 来说明。~~前面的阅读笔记，我将`sk_buff`和`Socket Buffer`混为一谈了。~~

